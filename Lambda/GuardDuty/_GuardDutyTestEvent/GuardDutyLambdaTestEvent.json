# works (details only)
curl -XPUT -u volker:Password1! https://search-canva-gpqk7fy3xguvkfnhczlw3yxqui.us-east-2.es.amazonaws.com/guardduty-2020-05-24/_doc/2 -d \
'{  "version": "0",  "id": "204dd832-e252-2cd0-0393-63637d23ac01",  "detail-type": "GuardDuty Finding",  "source": "aws.guardduty",  "account": "861828696892",  "time": "2020-05-24T09:10:14Z",  "region": "us-east-2",  "resources": [],  "detail": {    "schemaVersion": "2.0",    "accountId": "861828696892",    "region": "us-east-2",    "partition": "aws",    "id": "eeb8f4a34bda0a6baa31c032ace6cc06",    "arn": "arn:aws:guardduty:us-east-2:861828696892:detector/28b6b3514f345e675434138187fee13e/finding/eeb8f4a34bda0a6baa31c032ace6cc06",    "type": "UnauthorizedAccess:IAMUser/TorIPCaller",    "resource": {      "resourceType": "AccessKey",      "accessKeyDetails": {        "accessKeyId": "GeneratedFindingAccessKeyId",        "principalId": "GeneratedFindingPrincipalId",        "userType": "IAMUser",        "userName": "GeneratedFindingUserName"      },      "instanceDetails": {        "instanceId": "i-99999999",        "instanceType": "m3.xlarge",        "outpostArn": "arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3",        "launchTime": "2016-08-02T02:05:06Z",        "platform": "None",        "productCodes": [          {            "productCodeId": "GeneratedFindingProductCodeId",            "productCodeType": "GeneratedFindingProductCodeType"          }        ],        "iamInstanceProfile": {          "arn": "GeneratedFindingInstanceProfileArn",          "id": "GeneratedFindingInstanceProfileId"        },        "networkInterfaces": [          {            "networkInterfaceId": "eni-bfcffe88",            "privateIpAddresses": [              {                "privateDnsName": "GeneratedFindingPrivateName",                "privateIpAddress": "10.0.0.1"              }            ],            "subnetId": "GeneratedFindingSubnetId",            "vpcId": "GeneratedFindingVPCId",            "privateDnsName": "GeneratedFindingPrivateDnsName",            "securityGroups": [              {                "groupName": "GeneratedFindingSecurityGroupName",                "groupId": "GeneratedFindingSecurityId"              }            ],            "publicIp": "198.51.100.0",            "ipv6Addresses": [],            "publicDnsName": "GeneratedFindingPublicDNSName",            "privateIpAddress": "10.0.0.1"          }        ],        "tags": [          {            "value": "GeneratedFindingInstaceValue1",            "key": "GeneratedFindingInstaceTag1"          },          {            "value": "GeneratedFindingInstaceTagValue2",            "key": "GeneratedFindingInstaceTag2"          },          {            "value": "GeneratedFindingInstaceTagValue3",            "key": "GeneratedFindingInstaceTag3"          },          {            "value": "GeneratedFindingInstaceTagValue4",            "key": "GeneratedFindingInstaceTag4"          },          {            "value": "GeneratedFindingInstaceTagValue5",            "key": "GeneratedFindingInstaceTag5"          },          {            "value": "GeneratedFindingInstaceTagValue6",            "key": "GeneratedFindingInstaceTag6"          },          {            "value": "GeneratedFindingInstaceTagValue7",            "key": "GeneratedFindingInstaceTag7"          },          {            "value": "GeneratedFindingInstaceTagValue8",            "key": "GeneratedFindingInstaceTag8"          },          {            "value": "GeneratedFindingInstaceTagValue9",            "key": "GeneratedFindingInstaceTag9"          }        ],        "instanceState": "running",        "availabilityZone": "GeneratedFindingInstaceAvailabilityZone",        "imageId": "ami-99999999",        "imageDescription": "GeneratedFindingInstaceImageDescription"      }    },    "service": {      "serviceName": "guardduty",      "detectorId": "28b6b3514f345e675434138187fee13e",      "action": {        "actionType": "AWS_API_CALL",        "awsApiCallAction": {          "api": "GeneratedFindingAPIName",          "serviceName": "GeneratedFindingAPIServiceName",          "callerType": "Remote IP",          "remoteIpDetails": {            "ipAddressV4": "198.51.100.0",            "organization": {              "asn": "-1",              "asnOrg": "GeneratedFindingASNOrg",              "isp": "GeneratedFindingISP",              "org": "GeneratedFindingORG"            },            "country": {              "countryName": "GeneratedFindingCountryName"            },            "city": {              "cityName": "GeneratedFindingCityName"            },            "geoLocation": {              "lat": 0,              "lon": 0            }          },          "affectedResources": {}        }      },      "resourceRole": "TARGET",      "additionalInfo": {        "apiCalls": [          {            "lastSeen": 1513312096,            "firstSeen": 1513312082,            "name": "GeneratedFindingAPIName1",            "count": 2          },          {            "lastSeen": 1513312095,            "firstSeen": 1513312081,            "name": "GeneratedFindingAPIName2",            "count": 2          }        ],        "sample": "True"      },      "evidence": {        "threatIntelligenceDetails": [          {            "threatNames": [              "GeneratedFindingThreatName"            ],            "threatListName": "GeneratedFindingThreatListName"          }        ]      },      "eventFirstSeen": "2020-05-16T09:17:29.908Z",      "eventLastSeen": "2020-05-24T09:09:42.376Z",      "archived": "False",      "count": 7    },    "severity": 5,    "createdAt": "2020-05-16T09:17:29.908Z",    "updatedAt": "2020-05-24T09:09:42.376Z",    "title": "API GeneratedFindingAPIName was invoked from a Tor exit node.",    "description": "API GeneratedFindingAPIName was invoked from a Tor exit node IP address 198.51.100.0."  }}' \
-H 'Content-Type: application/json'



# untouched
curl -XPUT -u volker:Password1! https://search-canva-gpqk7fy3xguvkfnhczlw3yxqui.us-east-2.es.amazonaws.com/guardduty-2020-05-24/_doc/3 -d \
'{"schemaVersion": "2.0", "accountId": "861828696892", "region": "us-east-2", "partition": "aws", "id": "b6b8f4a34bdfb24681cdb74b7610bcc6", "arn": "arn:aws:guardduty:us-east-2:861828696892:detector/28b6b3514f345e675434138187fee13e/finding/b6b8f4a34bdfb24681cdb74b7610bcc6", "type": "Trojan:EC2/DGADomainRequest.C!DNS", "resource": {"resourceType": "Instance", "instanceDetails": {"instanceId": "i-99999999", "instanceType": "m3.xlarge", "outpostArn": "arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3", "launchTime": "2016-08-02T02:05:06Z", "platform": null, "productCodes": [{"productCodeId": "GeneratedFindingProductCodeId", "productCodeType": "GeneratedFindingProductCodeType"}], "iamInstanceProfile": {"arn": "GeneratedFindingInstanceProfileArn", "id": "GeneratedFindingInstanceProfileId"}, "networkInterfaces": [{"networkInterfaceId": "eni-bfcffe88", "privateIpAddresses": [{"privateDnsName": "GeneratedFindingPrivateName", "privateIpAddress": "10.0.0.1"}], "subnetId": "GeneratedFindingSubnetId", "vpcId": "GeneratedFindingVPCId", "privateDnsName": "GeneratedFindingPrivateDnsName", "securityGroups": [{"groupName": "GeneratedFindingSecurityGroupName", "groupId": "GeneratedFindingSecurityId"}], "publicIp": "198.51.100.0", "ipv6Addresses": [], "publicDnsName": "GeneratedFindingPublicDNSName", "privateIpAddress": "10.0.0.1"}], "tags": [{"value": "GeneratedFindingInstaceValue1", "key": "GeneratedFindingInstaceTag1"}, {"value": "GeneratedFindingInstaceTagValue2", "key": "GeneratedFindingInstaceTag2"}, {"value": "GeneratedFindingInstaceTagValue3", "key": "GeneratedFindingInstaceTag3"}, {"value": "GeneratedFindingInstaceTagValue4", "key": "GeneratedFindingInstaceTag4"}, {"value": "GeneratedFindingInstaceTagValue5", "key": "GeneratedFindingInstaceTag5"}, {"value": "GeneratedFindingInstaceTagValue6", "key": "GeneratedFindingInstaceTag6"}, {"value": "GeneratedFindingInstaceTagValue7", "key": "GeneratedFindingInstaceTag7"}, {"value": "GeneratedFindingInstaceTagValue8", "key": "GeneratedFindingInstaceTag8"}, {"value": "GeneratedFindingInstaceTagValue9", "key": "GeneratedFindingInstaceTag9"}], "instanceState": "running", "availabilityZone": "GeneratedFindingInstaceAvailabilityZone", "imageId": "ami-99999999", "imageDescription": "GeneratedFindingInstaceImageDescription"}}, "service": {"serviceName": "guardduty", "detectorId": "28b6b3514f345e675434138187fee13e", "action": {"actionType": "DNS_REQUEST", "dnsRequestAction": {"domain": "GeneratedFindingDomainName", "protocol": "UDP", "blocked": true}}, "resourceRole": "TARGET", "additionalInfo": {"threatListName": "GeneratedFindingThreatListName", "sample": true}, "evidence": {"threatIntelligenceDetails": [{"threatNames": ["GeneratedFindingThreatName"], "threatListName": "GeneratedFindingThreatListName"}]}, "eventFirstSeen": "2020-05-06T09:17:29.919Z", "eventLastSeen": "2020-05-24T11:18:33.811Z", "archived": false, "count": 23}, "severity": 8, "createdAt": "2020-05-06T09:17:29.919Z", "updatedAt": "2020-05-24T11:18:33.811Z", "title": "DGA domain name queried by EC2 instance i-99999999.", "description": "EC2 instance i-99999999 is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.", "Lambda": {"function_name": "SecurityLake_GuardDuty", "function_version": "$LATEST", "invoked_function_arn": "arn:aws:lambda:us-east-2:861828696892:function:SecurityLake_GuardDuty", "memory_limit_in_mb": "128", "time": "2020-05-24T11:20:00Z", "account": "861828696892", "region": "us-east-2"}}'\
 -H 'Content-Type: application/json'


# all in double quotes (incl numbers 23 and 8)
curl -XPUT -u volker:Password1! https://search-canva-gpqk7fy3xguvkfnhczlw3yxqui.us-east-2.es.amazonaws.com/guardduty-2020-05-24/_doc/3 -d \
'{"schemaVersion": "2.0", "accountId": "861828696892", "region": "us-east-2", "partition": "aws", "id": "b6b8f4a34bdfb24681cdb74b7610bcc6", "arn": "arn:aws:guardduty:us-east-2:861828696892:detector/28b6b3514f345e675434138187fee13e/finding/b6b8f4a34bdfb24681cdb74b7610bcc6", "type": "Trojan:EC2/DGADomainRequest.C!DNS", "resource": {"resourceType": "Instance", "instanceDetails": {"instanceId": "i-99999999", "instanceType": "m3.xlarge", "outpostArn": "arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3", "launchTime": "2016-08-02T02:05:06Z", "platform": "null", "productCodes": [{"productCodeId": "GeneratedFindingProductCodeId", "productCodeType": "GeneratedFindingProductCodeType"}], "iamInstanceProfile": {"arn": "GeneratedFindingInstanceProfileArn", "id": "GeneratedFindingInstanceProfileId"}, "networkInterfaces": [{"networkInterfaceId": "eni-bfcffe88", "privateIpAddresses": [{"privateDnsName": "GeneratedFindingPrivateName", "privateIpAddress": "10.0.0.1"}], "subnetId": "GeneratedFindingSubnetId", "vpcId": "GeneratedFindingVPCId", "privateDnsName": "GeneratedFindingPrivateDnsName", "securityGroups": [{"groupName": "GeneratedFindingSecurityGroupName", "groupId": "GeneratedFindingSecurityId"}], "publicIp": "198.51.100.0", "ipv6Addresses": [], "publicDnsName": "GeneratedFindingPublicDNSName", "privateIpAddress": "10.0.0.1"}], "tags": [{"value": "GeneratedFindingInstaceValue1", "key": "GeneratedFindingInstaceTag1"}, {"value": "GeneratedFindingInstaceTagValue2", "key": "GeneratedFindingInstaceTag2"}, {"value": "GeneratedFindingInstaceTagValue3", "key": "GeneratedFindingInstaceTag3"}, {"value": "GeneratedFindingInstaceTagValue4", "key": "GeneratedFindingInstaceTag4"}, {"value": "GeneratedFindingInstaceTagValue5", "key": "GeneratedFindingInstaceTag5"}, {"value": "GeneratedFindingInstaceTagValue6", "key": "GeneratedFindingInstaceTag6"}, {"value": "GeneratedFindingInstaceTagValue7", "key": "GeneratedFindingInstaceTag7"}, {"value": "GeneratedFindingInstaceTagValue8", "key": "GeneratedFindingInstaceTag8"}, {"value": "GeneratedFindingInstaceTagValue9", "key": "GeneratedFindingInstaceTag9"}], "instanceState": "running", "availabilityZone": "GeneratedFindingInstaceAvailabilityZone", "imageId": "ami-99999999", "imageDescription": "GeneratedFindingInstaceImageDescription"}}, "service": {"serviceName": "guardduty", "detectorId": "28b6b3514f345e675434138187fee13e", "action": {"actionType": "DNS_REQUEST", "dnsRequestAction": {"domain": "GeneratedFindingDomainName", "protocol": "UDP", "blocked": "true"}}, "resourceRole": "TARGET", "additionalInfo": {"threatListName": "GeneratedFindingThreatListName", "sample": "true"}, "evidence": {"threatIntelligenceDetails": [{"threatNames": ["GeneratedFindingThreatName"], "threatListName": "GeneratedFindingThreatListName"}]}, "eventFirstSeen": "2020-05-06T09:17:29.919Z", "eventLastSeen": "2020-05-24T11:18:33.811Z", "archived": "false", "count": "23"}, "severity": "8", "createdAt": "2020-05-06T09:17:29.919Z", "updatedAt": "2020-05-24T11:18:33.811Z", "title": "DGA domain name queried by EC2 instance i-99999999.", "description": "EC2 instance i-99999999 is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance."}'\
 -H 'Content-Type: application/json'
